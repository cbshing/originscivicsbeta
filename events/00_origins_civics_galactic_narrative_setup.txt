namespace = origins_civics_galactic_narrative_setup
# by cbshing

### Galactic Narrative Setup
# Determines the Galactic Narrative

# Gatekeeper
event = {
	id = origins_civics_galactic_narrative_setup.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = has_oc_galactive_narrative }
	}
	
	immediate = {
		random_country = {
			limit = { is_country_type = global_event }
			random_list = {
				10 = { ### Generic Galactic Imperium 
					modifier = {
						factor = 0
						NOT = {
							any_country = {
								OR = {
									is_country_type = fallen_empire
									is_country_type = awakened_empire
								}
							}
						}
					}
					set_global_flag = has_oc_galactive_narrative
					set_global_flag = oc_generic_galactic_imperium_narrative
				}
				10 = { ### Generic Galactic Imperium 
					modifier = {
						factor = 0
						NOT = {
							any_country = {
								OR = {
									is_country_type = fallen_empire
									is_country_type = awakened_empire
								}
							}
						}
					}
					set_global_flag = has_oc_galactive_narrative
					set_global_flag = oc_generic_galactic_imperium_narrative
				}
				10 = { ### Generic Galactic Imperium 
					modifier = {
						factor = 0
						NOT = {
							any_country = {
								OR = {
									is_country_type = fallen_empire
									is_country_type = awakened_empire
								}
							}
						}
					}
					set_global_flag = has_oc_galactive_narrative
					set_global_flag = oc_generic_galactic_imperium_narrative
				}
				120 = { }
			}
		}
	}
}

country_event = {
	id = origins_civics_galaxy_setup.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = has_oc_galactive_narrative
		is_country_type = fallen_empire
		NOT = { has_country_flag = species_changed }
	}
	
	immediate = {
		owner_species = { save_event_target_as : primary_fallen_species }
		every_country = {
			limit = {
				is_country_type = fallen_empire
				NOT = { has_country_flag = species_changed }
			}
			speci
		}
	}
}
